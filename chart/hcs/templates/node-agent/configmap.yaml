{{- if .Values.nodeAgent.enabled }}
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "hcs.fullname" . }}-node-agent-config
  namespace: {{ include "hcs.namespace" . }}
  labels:
    {{- include "hcs.nodeAgent.labels" . | nindent 4 }}
data:
  config.yaml: |
    # Node Agent Configuration
    reportInterval: {{ .Values.nodeAgent.reportInterval }}s
    logLevel: {{ .Values.nodeAgent.logLevel }}

    # Hardware detection settings
    detection:
      nvidia:
        enabled: true
        nvmlLibPath: "/usr/local/nvidia/lib64/libnvidia-ml.so.1"
      huawei:
        enabled: true
        dsmiLibPath: "/usr/local/Ascend/driver/lib64/libdsmi.so"
      hygon:
        enabled: true
        hipLibPath: "/opt/rocm/lib/libamdhip64.so"
      cambricon:
        enabled: true
        cnmonLibPath: "/usr/local/neuware/lib64/libcnmon.so"

    # Interceptor library deployment
    interceptor:
      enabled: {{ .Values.interceptor.enabled }}
      hostPath: {{ .Values.interceptor.hostPath }}
{{- end }}
